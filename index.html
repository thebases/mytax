<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Tra c·ª©u & l∆∞u th√¥ng tin xu·∫•t ho√° ƒë∆°n</title>

    <!-- Primary PWA tags -->
    <link rel="manifest" href="manifest.webmanifest" />
    <meta
      name="theme-color"
      content="#ffffff"
      media="(prefers-color-scheme: light)"
    />
    <meta
      name="theme-color"
      content="#0b0b0b"
      media="(prefers-color-scheme: dark)"
    />
    <meta
      name="description"
      content="·ª®ng d·ª•ng PWA gi√∫p tra c·ª©u v√† l∆∞u th√¥ng tin xu·∫•t ho√° ƒë∆°n theo m√£ s·ªë thu·∫ø. D√πng offline, kh√¥ng c·∫ßn ƒëƒÉng k√Ω."
    />
    <meta
      name="keywords"
      content="m√£ s·ªë thu·∫ø, tra c·ª©u m√£ s·ªë thu·∫ø, th√¥ng tin xu·∫•t ho√° ƒë∆°n, ho√° ƒë∆°n ƒëi·ªán t·ª≠, l∆∞u th√¥ng tin ho√° ƒë∆°n, pwa, ·ª©ng d·ª•ng web"
    />
    <meta name="author" content="The Base" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://thebase.vn/mytax/" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="Tra c·ª©u MST" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="referrer" content="no-referrer" />
    <link rel="shortcut icon" href="icons/icon-192x192.png" />
    <link rel="icon" href="icons/icon-192x192.png" sizes="192x192" />
    <link rel="apple-touch-icon" href="icons/icon-192x192.png" />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            boxShadow: { card: "0 10px 25px rgba(0,0,0,0.08)" },
            borderRadius: { "2xl": "1rem" },
          },
        },
      };
    </script>

    <link rel="stylesheet" href="app.css" />
  </head>
  <body
    class="min-h-svh max-h-svh w-full bg-zinc-50 text-zinc-900 dark:bg-zinc-950 dark:text-zinc-100 flex flex-col items-center justify-center"
  >
    <div
      id="app"
      class="min-h-svh max-h-svh max-w-[480px] min-w-[360px] flex flex-col bg-zinc-50 text-zinc-900 dark:bg-zinc-950 dark:text-zinc-100"
    >
      <header class="container mx-auto p-4">
        <div id="appHeader" class="flex flex-col items-center justify-between pt-4">
          <h1 class="text-2xl font-semibold tracking-tight">
            Th√¥ng tin xu·∫•t ho√° ƒë∆°n
          </h1>
          <button id="installBtn" class="btn hidden" type="button">
            C√†i ƒë·∫∑t PWA
          </button>
        </div>
      </header>

      <main class="container w-full min-w-[360px] max-w-[480px] px-4 flex-1 overflow-auto">
        <!-- WELCOME / FIRST TIME SCREEN -->
        <section class="card p-0 " id="welcomeSection"
        >
          <div>
          <h2 class="text-xl font-semibold mb-3 px-4">Xin ch√†o üëã</h2>
          <p class="text-md  mb-4 text-justify">
            ƒê√¢y l√† m·ªôt s·∫£n ph·∫©m c·ªông ƒë·ªìng, gi√∫p b·∫°n tra c·ª©u v√† l∆∞u th√¥ng tin xu·∫•t ho√° ƒë∆°n theo
            m√£ s·ªë thu·∫ø. ·ª®ng d·ª•ng ho·∫°t ƒë·ªông offline, kh√¥ng c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n.
          </p>
          <p class="text-md  mb-4 text-justify px-4">
            <i>C√°c b∆∞·ªõc ƒë·ªÉ s·ª≠ d·ª•ng:</i>
          </p>
          <p class="text-md text-zinc-600 dark:text-zinc-400 text-justify mb-4 px-4">
            <ol class="text-justify mb-4">
              <li><b>B∆∞·ªõc 1:</b>  Nh·∫≠p <strong>M√£ s·ªë thu·∫ø</strong>, ƒë·ªãa chi email ƒë·ªÉ nh·∫≠n h√≥a ƒë∆°n v√† s·ªë ƒëi·ªán tho·∫°i (n·∫øu c√≥).</li>
            
            <li><b>B∆∞·ªõc 2:</b> ·ª®ng d·ª•ng s·∫Ω t·ª± ƒë·ªông tra c·ª©u th√¥ng tin doanh nghi·ªáp bƒÉng m√£ s·ªë thu·∫ø.</li>
            <li><b>B∆∞·ªõc 3:</b> L∆∞u th√¥ng tin v√† s·ª≠ d·ª•ng khi c·∫ßn xu·∫•t ho√° ƒë∆°n.</li>
            </ol>
          </p>
          <p class=" text-sm text-zinc-500 dark:text-zinc-400 text-justify px-4">
            <p class="text-md  text-justify">
            <i>L∆∞u √Ω:</i>
          </p>
            <ul class="text-justify px-4">
              <li><b>1.</b> Th√¥ng tin doanh nghi·ªáp m√† s·∫£n ph·∫©m cung c·∫•p ƒë∆∞·ª£c t·ªïng h·ª£p t·ª´ nhi·ªÅu ngu·ªìn kh√°c nhau n√™n c√≥ th·ªÉ ch∆∞a l√† th√¥ng tin ch√≠nh x√°c nh·∫•t. Do ƒë√≥, b·∫°n c·∫ßn ki·ªÉm tra l·∫°i th√¥ng tin tr∆∞·ªõc khi s·ª≠ d·ª•ng.</li>
            
            <li><b>2.</b> S·∫£n ph·∫©m n√†y ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ ch·∫°y offline v√† 100% t·∫°i client side. Do ƒë√≥ Ch√∫ng T√¥i ho√†n to√†n kh√¥ng ch·ªãu tr√°ch nhi·ªám v·ªÅ c√°c th√¥ng tin do b·∫°n ƒë∆∞a v√†o s·∫£n ph·∫©m.</li>
            <li><b>3.</b> B·∫°n c√≥ th·ªÉ g·ª≠i email v·ªÅ ƒë·ªãa ch·ªâ <a href="email:community@thebase.vn">community@thebase.vn</a> ƒë·ªÉ Ch√∫ng T√¥i c√≥ th·ªÉ h·ªó tr·ª£ th√™m cho b·∫°n.</li>
            </ul>
          </p>
          <button
            id="startBtn"
            class="btn btn-primary w-full mt-4 mx-2 p-3 bg-black text-white dark:bg-zinc-100 dark:text-zinc-900 rounded-md "
            type="button"
          >
            B·∫Øt ƒë·∫ßu ngay
          </button>
          </div>
        </section>
        <!-- 1) FORM TRA C·ª®U / TH√äM -->
        <section class="card p-0 hidden-section" id="querySection">
          <div class="w-full flex flex-col gap-3">
            <div class="row flex flex-col">
              <label class="label text-xs text-zinc-500" for="taxCode"
                >M√£ s·ªë thu·∫ø</label
              >
              <input
                id="taxCode"
                class="input mt-1 text-zinc-900 dark:text-zinc-100 dark:bg-zinc-800 font-medium rounded-lg p-3"
                placeholder="Nh·∫≠p m√£ s·ªë thu·∫ø (10/12/13 ch·ªØ s·ªë)"
                inputmode="numeric"
                autocomplete="off"
              />
              <p class="mt-2 text-xs text-zinc-500">
                M·∫πo: nh·∫•n <span class="kbd">Enter</span> ƒë·ªÉ tra nhanh.
              </p>
            </div>

            <div class="row flex flex-col">
              <label class="label text-xs text-zinc-500" for="email"
                >Email</label
              >
              <input
                id="email"
                class="input mt-1 text-zinc-900 dark:text-zinc-100 dark:bg-zinc-800 font-medium rounded-lg p-3"
                placeholder="Nh·∫≠p Email (VD: abc@a.com)"
                autocomplete="off"
              />
            </div>

            <div class="row flex flex-col">
              <label class="label text-xs text-zinc-500" for="phone"
                >S·ªë ƒëi·ªán tho·∫°i</label
              >
              <input
                id="phone"
                class="input mt-1 text-zinc-900 dark:text-zinc-100 dark:bg-zinc-800 font-medium rounded-lg p-3"
                placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i (VD: 0901234567)"
                inputmode="tel"
                autocomplete="off"
              />
            </div>
          </div>

          <div class="w-full mt-4 flex flex-col gap-3">
            <div class="ml-auto flex flex-col items-center gap-2 w-full">
              <div class="flex flex-row items-center gap-2 w-full">
                <button
                  id="queryBtn"
                  class="btn btn-primary dark:bg-zinc-100 dark:text-zinc-900 rounded-md p-2 flex-1"
                  type="button"
                >
                  Th√™m
                </button>
                <button
                  id="clearAllBtn"
                  class="btn dark:bg-zinc-100 dark:text-zinc-900 rounded-md p-2 flex-1"
                  type="button"
                  title="Xo√° t·∫•t c·∫£ d·ªØ li·ªáu"
                >
                  Xo√° t·∫•t c·∫£
                </button>
              </div>
              <button
                id="gotoListBtn"
                class="btn rounded-md p-2 flex-1"
                type="button"
              >
                V·ªÅ danh s√°ch
              </button>
            </div>
          </div>

          <p id="status" class="mt-4 text-sm text-zinc-600"></p>
        </section>

        <!-- 2) DANH S√ÅCH ƒê√É L∆ØU -->
        <section class="card p-0 hidden-section" id="listSection">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-lg font-semibold">MST ƒë√£ l∆∞u</h2>
            <div class="flex items-center gap-2">
              <span
                id="countBadge"
                class="badge border-zinc-200 bg-zinc-50 dark:bg-zinc-800 dark:text-zinc-50 text-xs py-1 px-2 rounded-md"
              ></span>
              <button id="addNewBtn" class="btn px-3" title="Th√™m m·ªõi MST">
                ‚ûï
              </button>
            </div>
          </div>
          <div id="list" class="grid gap-2">
            <p class="text-sm text-zinc-500">
              Ch∆∞a c√≥ d·ªØ li·ªáu. H√£y th√™m b·∫£n ghi ·ªü m√†n h√¨nh ‚ÄúTra c·ª©u‚Äù.
            </p>
          </div>
        </section>

        <!-- 3) CHI TI·∫æT MST -->
        <section class="card p-0 hidden-section" id="detailSection">
          <div class="flex flex-col items-center justify-between">
            <!-- <h2 class="flex flex-row text-lg font-semibold">
            Chi ti·∫øt MST
            <span
              id="typeBadge"
              class="badge border-zinc-200 bg-zinc-50 dark:bg-zinc-800 dark:text-zinc-700 text-center rounded-md text-[10px] px-2 py-0 ml-2"
            ></span>
          </h2> -->
            <div class="w-full flex flex-row items-center justify-start gap-2">
              <button id="backToListBtn" class="btn flex-1 text-left">
                ‚Üê Danh s√°ch
              </button>
              <button id="qrBtn" class="btn flex flex-row">
                <!-- <img src="icons/qr-code.svg" class="mr-1" alt="QR">  -->
                <div class="qrcode mr-2" aria-label="QR logo"></div>
                QR
              </button>
              <button id="editBtn" class="btn">‚úèÔ∏è S·ª≠a</button>
              <button id="deleteOneBtn" class="btn">üóëÔ∏è Xo√°</button>
            </div>
          </div>

          <div class="grid grid-cols-1 gap-3 mt-4">
            <div class="rounded-xl border p-3">
              <div class="text-xs text-zinc-500">T√™n doanh nghi·ªáp</div>
              <div id="d_name" class="mt-1 font-medium break-words">‚Äî</div>
            </div>
          </div>
          <div class="grid grid-cols-1 gap-3 mt-3">
            <div class="rounded-xl border p-3">
              <div class="text-xs text-zinc-500">ƒê·ªãa ch·ªâ</div>
              <div id="d_addr_view" class="mt-1 font-medium break-words"></div>
              <textarea
                id="d_addr_edit"
                class="input mt-2 hidden font-medium break-words text-zinc-800"
                rows="3"
                placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ"
              ></textarea>
            </div>
            <div class="rounded-xl border p-3">
              <div class="text-xs text-zinc-500">M√£ s·ªë thu·∫ø</div>
              <div id="d_taxId" class="mt-1 font-medium break-words">‚Äî</div>
            </div>
            <div class="rounded-xl border p-3">
              <div class="text-xs text-zinc-500">S·ªë ƒëi·ªán tho·∫°i</div>
              <div id="d_phone_view" class="mt-1 font-medium break-words"></div>
              <input
                id="d_phone_edit"
                class="input mt-2 hidden text-zinc-800"
                placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"
              />
            </div>
            <div class="rounded-xl border p-3">
              <div class="text-xs text-zinc-500">Email</div>
              <div id="d_email_view" class="mt-1 font-medium break-words"></div>
              <input
                id="d_email_edit"
                class="input mt-2 hidden text-zinc-800"
                placeholder="Nh·∫≠p email"
              />
            </div>
          </div>

          <div class="mt-4 flex flex-row items-center gap-2">
            <button id="saveBtn" class="btn btn-primary hidden flex-1">
              L∆∞u
            </button>
            <button id="cancelBtn" class="btn hidden flex-1">Hu·ª∑</button>
          </div>
        </section>
      </main>

      <!-- PWA Install Modal -->
      <div
        id="installModal"
        class="fixed inset-0 z-50 items-center justify-center bg-black/40 p-4"
      >
        <div class="card max-w-sm w-full p-5 bg-white dark:bg-zinc-900">
          <h3 class="text-lg font-semibold">C√†i ƒë·∫∑t ·ª©ng d·ª•ng?</h3>
          <p class="text-sm text-zinc-600 dark:text-zinc-400 mt-2">
            C√†i ƒë·∫∑t ƒë·ªÉ d√πng nhanh nh∆∞ app, ho·∫°t ƒë·ªông offline v√† m·ªü to√†n m√†n
            h√¨nh.
          </p>
          <div class="mt-4 flex gap-2">
            <button id="installNow" class="btn btn-primary flex-1">
              C√†i ƒë·∫∑t
            </button>
            <button id="installLater" class="btn flex-1">ƒê·ªÉ sau</button>
          </div>
        </div>
      </div>

      <!-- iOS Install Hint Modal -->
      <div
        id="iosInstallModal"
        class="fixed inset-0 z-50 hidden items-center justify-center bg-black/40 p-4"
      >
        <div class="card max-w-sm w-full p-5 bg-white dark:bg-zinc-900">
          <h3 class="text-lg font-semibold">Th√™m v√†o M√†n h√¨nh ch√≠nh</h3>
          <p class="text-sm text-zinc-600 dark:text-zinc-400 mt-2">
            ƒê·ªÉ l∆∞u ·ª©ng d·ª•ng tr√™n iPhone/iPad, h√£y th√™m v√†o m√†n h√¨nh ch√≠nh.
          </p>

          <div class="mt-4 flex gap-2">
            <button id="iosBookmarkBtn" class="btn btn-primary flex-1">
              üìå Bookmark ngay
            </button>
            <button id="iosInstallClose" class="btn flex-1">ƒê·ªÉ sau</button>
          </div>

          <!-- Step guide (hidden until button clicked) -->
          <div id="iosSteps" class="mt-4 text-sm hidden">
            <ol class="list-decimal list-inside space-y-1">
              <li>
                M·ªü menu <strong>Chia s·∫ª</strong> (bi·ªÉu t∆∞·ª£ng
                <span class="text-lg">‚¨ÜÔ∏è</span>) trong Safari.
              </li>
              <li>Ch·ªçn <strong>Th√™m v√†o M√†n h√¨nh ch√≠nh</strong>.</li>
            </ol>
          </div>
        </div>
      </div>

      <!-- QR Modal -->
      <div
        id="qrModal"
        class="fixed inset-0 z-50 hidden items-center justify-center bg-black/40 p-4"
      >
        <div class="card max-w-sm w-full p-5 bg-white dark:bg-zinc-900">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold">Qu√©t QR</h3>
            <button id="qrClose" class="btn px-3 py-1 text-sm" type="button">
              ‚úñ
            </button>
          </div>

          <!-- Format ch·ªçn MECARD/VCARD + size -->
          <div class="mt-3 grid grid-cols-3 gap-2">
            <label class="label flex items-center gap-2">
              <input
                type="radio"
                name="qrFmt"
                value="VCARD"
                checked
                class="accent-sky-500"
              />
              vCard
            </label>
            <label class="label flex items-center gap-2">
              <input
                type="radio"
                name="qrFmt"
                value="MECARD"
                class="accent-sky-500"
              />
              MeCard
            </label>
            <label class="label flex items-center gap-2">
              <input
                type="radio"
                name="qrFmt"
                value="SIMPLE"
                class="accent-sky-500"
              />
              Simple
            </label>
            <label class="label col-span-2 flex items-center gap-2"
              >K√≠ch th∆∞·ªõc
              <select
                id="qrSize"
                class="input py-1 px-2 text-sm w-auto dark:bg-zinc-500 text-zinc-900"
              >
                <option value="200">200</option>
                <option value="240" selected>240</option>
                <option value="300">300</option>
              </select>
            </label>
          </div>

          <!-- QR code render box -->
          <div class="mt-4 flex items-center justify-center">
            <div
              id="qrBox"
              class="rounded-lg border border-zinc-200 dark:border-zinc-800 p-2 bg-white"
            ></div>
          </div>

          <!-- Copy & download -->
          <div class="mt-4 grid grid-cols-2 gap-2">
            <button id="qrCopy" class="btn" type="button">
              Sao ch√©p d·ªØ li·ªáu
            </button>
            <a
              id="qrDownload"
              class="btn btn-primary text-center"
              download="mst-qr.png"
              >T·∫£i QR</a
            >
          </div>
        </div>
      </div>

      <div id="toast" class="fixed top-4 left-1/2 -translate-x-1/2 z-50"></div>

      <footer class="container p-2 text-center text-xs text-zinc-500">
        Made by <a href="https://thebase.vn">The Base</a>
      </footer>
    </div>

    <script src="app.js"></script>
    <script src="easyqr.js"></script>
    <script src="qrbtn.js"></script>
  </body>
</html>
